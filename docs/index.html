<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>TuxLab Docs</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://tuxlab.org'>TuxLab Project</a></li>
            <li><a href='https://github.com/learnlinux'>GitHub Source</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="development-installation">Development Installation</h1>

<p>To make development and testing easier, we’ve developed a tool to simulate TuxLab’s infrastructure on your local machine.  To do this, we use the Vagrant framework, a programmatic wrapper to the popular VirtualBox Virtual Machine. This provides one platform that can be used across all machines, allowing TuxLab’s architecture to work the same way regardless of your operating system or environment.</p>

<p>In order to set up TuxLab using vagrant, you must first install several frameworks and libraries on your local machine. These are:</p>

<ul>
<li>VirtualBox (netadp, netflt, guest-iso)</li>
<li>Vagrant</li>
<li>Vagrant Guests Plugin</li>
<li>Ansible (Version 2.3 or above)</li>
<li>SSHPass</li>
</ul>

<p>The following set of instructions will walk you through installation on our currently supported platforms.</p>

<h2 id="red-hat-centos">Red Hat / CentOS</h2>

<h2 id="fedora">Fedora</h2>

<h2 id="ubuntu-debian">Ubuntu / Debian</h2>

<h3 id="before-you-begin">Before you Begin</h3>

<p>In order to ensure the installation process for your prerequisite programs goes smoothly, you should first make sure your package lists and installed programs are all up-to-date.  Run the following in Bash:</p>

<p><code class="prettyprint">sudo apt-get update</code><br>
<code class="prettyprint">sudo apt-get upgrade</code></p>

<aside class="notice">
    Note: running this second command will update all packages on your machine. This may include things like web browsers, so just keep in mind that running this second command may update more programs than are absolutely necessary. If you want to avoid this, it should be okay to omit the command.
</aside>

<h3 id="installing-virtualbox">Installing VirtualBox</h3>

<p>Luckily, you can install virtualbox via Ubuntu’s package manager with the command:
<code class="prettyprint">sudo apt-get install virtualbox</code></p>

<h3 id="installing-vagrant">Installing Vagrant</h3>

<h2 id="arch-linux-manjaro">Arch Linux / Manjaro</h2>

          <h1 id="production-installation">Production Installation</h1>

<p>TuxLab uses Ansible to automate the installation process, which makes TuxLab completely infrastructure-agnostic.  However, setting up the application using your own infrastructure is an advanced procedure.  To simplify this, we have created a local Ansible script which automates the process of installing TuxLab on Amazon Web Services, and includes features like auto-scaling and provisioning.</p>

<h2 id="aws">AWS</h2>

<h3 id="create-an-aws-account">Create an AWS Account</h3>

<p>In order to provision instances on AWS, you will need to create an AWS Account.  Students and instructors are eligible to receive free credits for AWS via their University, if you are looking to try out TuxLab without an initial cost.  To register, simply complete the form on AWS’ website:
<img alt="Signup for AWS" src="images/aws/aws_signup.png" /></p>

<aside class="notice">
Academic users (Students, Faculty, Administrators) are eligible to receive credit from Amazon Web Services.  The easiest way to do this is using the [GitHub Student Pack](https://education.github.com/pack).
</aside>

<h3 id="obtain-api-key">Obtain API Key</h3>

<p>You will then need to obtain an API Key, allowing the TuxLab installer to provision infrastructure on your account.  In order to do this, navigate to the “My Security Credentials” dropdown:</p>

<p><img alt="AWS Security Credentials" src="images/aws/aws_sec.png" /></p>

<p>Then choose “create new access key”:</p>

<p><img alt="AWS Keys" src="images/aws/aws_keys.png" /></p>

<p>And finally, choose to download the key file.  We will use this later in running the install script.</p>

<p><img alt="AWS Download Key" src="images/aws/aws_down.png" /></p>

<h2 id="ansible-tower">Ansible Tower</h2>

<h3 id="obtain-license-key">Obtain License Key</h3>

<p>In addition to the TuxLab server applications, the installer will install Ansible Tower, a tool used to automatically scale, provision and check the health of the TuxLab service.  Ansible Tower is an open source product, however it requires a license for updating, support, and ease of operation.  All users are entitled to a free Ansible Tower license for up to ten nodes (which is substantially larger than what is needed of most TuxLab installations). First, complete the registration online:</p>

<p><img alt="Ansible Tower Keys" src="images/aws/tower_signup.png" /></p>

<h3 id="accept-eula">Accept EULA</h3>

<p>You will then be emailed a license key, which is simply a JSON file.  You need to add a property; <code class="prettyprint">&quot;eula_accepted&quot; : true</code>, to this file, confirming that you have read the End User License Agreement.  Save this file for later use.</p>

<h2 id="setup-ansible">Setup Ansible</h2>

<p>Install Ansible and the prerequisites as explained earlier in the Development Installation section.</p>

<p>In addition, you need to install the boto package, which is used for interfacing with AWS.  The easiest way to install this is using PIP, which should work on all platforms:
<code class="prettyprint">pip install boto</code>.</p>

<h2 id="setup-mongodb">Setup MongoDB</h2>

<p>TuxLab relies on an external installation of MongoDB to store application data.  There are a number of ways to setup MongoDB, some of which are outlined in our later section on the Mongo component of TuxLab.  Prior to proceeding, it is important to make note of your MongoDB URL and authentication details, and insert them into the appropriate variable in the next step.</p>

<h2 id="configuring-tuxlab">Configuring TuxLab</h2>

<p>Prior to running the installation script, it is important that you review and edit the configuration settings.  These settings are outlined in detail in the configuration section of the documentation.</p>

<aside class="warning">
In setting up each server, Ansible automatically pulls the configuration details from the Git repository of each project (tuxlab-app, tuxlab-infra).  It is therefor essential that you fork these repositories, and edit the Git URL variables to use these repositories instead of the defaults.  This process is described in more depth in the Configuration documentation.
</aside>

<h2 id="installing-tuxlab">Installing TuxLab</h2>

<p>Run the following command, substituting the AWS_ACCESS_KEY_ID and the AWS_SECRET_ACCESS_KEY with the values you downloaded previously in the AWS keyfile:</p>

<p><code class="prettyprint">export AWS_ACCESS_KEY_ID=XXXXXXXXXXXXXX</code><br>
<code class="prettyprint">export AWS_SECRET_ACCESS_KEY=XXXXXXXXXXXXXXXXXXXX</code><br>
<code class="prettyprint">ansible-playbook site.yml</code></p>

<p>You will be prompted to enter an Ansible password, which you should take note of.  You will use it later to connect to the internet Ansible dashboard.</p>

<h2 id="setup-dns">Setup DNS</h2>

<p>Finally, create DNS records to route your domain to the TuxLab instance. If you wanted for the tuxlab app to be displayed at domain.com, you would set the following records:
<code class="prettyprint">NS   *.domain.com     &lt;SWARM_NODE_IP&gt;</code><br>
<code class="prettyprint">A      domain.com     &lt;LOAD_BALANCER_DNS_NAME&gt;</code><br>
Alternatively, If you are using Amazon Route 53, you can use <a href="http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/using-domain-names-with-elb.html#dns-associate-custom-elb">Aliases</a> to more easily configure these IP addresses.</p>

<h2 id="viewing-status-of-tuxlab-installation">Viewing Status of TuxLab Installation</h2>

<p>Once the command has run to completion, you will see a number of instances active on your AWS account:</p>

<p>Locate the one labeled “Ansible_Tower,” and note its public DNS Address.  If you enter this into your browser, prefixed by https://, you will pull up the Ansible Tower dashboard, which you can use to check the status of your TuxLab installation.</p>

          <h1 id="administration">Administration</h1>

          <h1 id="lab-api">Lab API</h1>

<p>TuxLab is centered around the concept of a &ldquo;Lab&rdquo;- which consists of 1) a series of instructions presented to the user 2) a Linux Environment setup to complete these tasks and 3) a set of tests to verify the students&rsquo; completion of a task, as well as access student data.  All of these things are defined in a single Javascript file- called a LabFile.  A LabFile follows a particular format, described below.</p>

<h2 id="creating-the-lab">Creating the Lab</h2>
<pre class="highlight javascript"><code>
<span class="kd">var</span> <span class="nx">gitLab1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">lab</span><span class="p">();</span>
</code></pre>

<p>Every lab file is a modification on a lab object, created and initialized on the server side. This gives the tuxlab API the ability to change and adapt to advances in the server side code and other tools being used, without needing to modify any specific lab file.</p>

<p>Thus, all labfiles must start with creating a new lab object. By running the command <code>var myLab = new lab();</code></p>

<h3 id="setup">Setup</h3>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">setup</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">env</span><span class="p">){</span>
  <span class="nx">env</span><span class="p">.</span><span class="nx">init</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>

<p>Setup is a function that takes as an input an environment object. The setup function runs for each individual user before the lab is started. Therefore, it is essential that it starts with an e<code>env.init()</code> call which initializes the environment for the user.</p>

<p>Although the setup function can consist on only env.init(), it is important to provide as many of the tools, files and folders a student might use in the setup function to increase efficiency.</p>

<h3 id="tasks">Tasks</h3>

<p>Tasks are the individual steps a student goes through. Instructors can create as many tasks per lab and grade them and give feedback to students directly from the labfile using the student API.
Each task is created by a lab.newTask method, taking as input the title, a setup and verifier functions.</p>

<h4 id="task-setup">Task setup</h4>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">setup</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">env</span><span class="p">){</span>
  <span class="nx">env</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"git clone https://github.com/cemersoz/gitlab-setup1"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"./gitlab-setup1/deploy.sh"</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"rm -rf ./gitlab-setup1"</span><span class="p">));</span>
<span class="p">}</span>
</code></pre>

<p>Each task setup is a function, taking as paramater an environment object. This function is called for each student environment to setup the tasks for each student. Every setup function MUST start with a <code>return env.start()</code> statement, although other steps can be chained to the end. It is crucial for the API to have the setup function return an environment promise.
<aside class = "notice">The setup function is run before the task is attempted.</aside></p>

<p>It is important to note that while cloning git repositories is possible in the setup, it takes individual time and data connection for each user which are crucial and expensive resources. We suggest using regular unix commands and not relying on git as much as possible.</p>

<h3 id="task-verify">Task verify</h3>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">verifier</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">env</span><span class="p">,</span><span class="nx">student</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">env</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"pwd /"</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">sOut</span><span class="p">,</span><span class="nx">sErr</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">sOut</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">"my_dir"</span><span class="p">)){</span>
        <span class="nx">student</span><span class="p">.</span><span class="nx">setGrade</span><span class="p">(</span><span class="mi">1</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nx">env</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">},</span><span class="kd">function</span><span class="p">(){</span>
      <span class="nx">student</span><span class="p">.</span><span class="nx">setGrade</span><span class="p">(</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span>
      <span class="nx">student</span><span class="p">.</span><span class="nx">feedback</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">"# Task failed\n## you did not create the directory \"my_dir\""</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">env</span><span class="p">.</span><span class="nx">reject</span><span class="p">();</span>
    <span class="p">});</span>

<span class="p">};</span>
</code></pre>

<p>Each task verify is a function taking as parameter an environment object and a student object. The verifier is run when a student clicks the <code>verify</code> button. A verifier function must result either in an <code>env.resolve()</code> or an <code>env.reject()</code> statement.</p>

<aside class = "notice">All verifiers must either resolve or reject the progress</aside>

<p>For graded tasks, it is important to set the grades of the students in the verifier, depending on their progress. It is also possible to give situation-specific feedback, in markdown format, using the student.feedback function call.</p>

<h4 id="task-description">Task Description</h4>
<pre class="highlight javascript"><code><span class="cm">/*@Task1
# This is Task1
## You can write markdown as a comment!
### Isn't that cool!
*/</span>
</code></pre>

<p>Task descriptions are written in the markdown format, also in the labfile. You can directly write your description, anywhere on the labfile, starting with <code>@task_name</code> in any multi-line comment. All task description are parsed out from labfiles by our regular expression matcher and added to the database! Coming with the beta release, you can add your markdown descriptions in our very own markdown formatter!</p>

<h3 id="creating-and-chaining-tasks">Creating and Chaining Tasks</h3>

<blockquote>
<p>Lets create a task with the setup and verifier from above.</p>
</blockquote>
<pre class="highlight javascript"><code>
<span class="kd">var</span> <span class="nx">task1</span> <span class="o">=</span> <span class="nx">lab</span><span class="p">.</span><span class="nx">newTask</span><span class="p">(</span><span class="s2">"mkdirTask"</span><span class="p">,</span><span class="nx">setup</span><span class="p">,</span><span class="nx">verifier</span><span class="p">);</span>
</code></pre>

<p>Tasks are created by the lab.newTask call, with paramaters taskName, setup and verifier functions.</p>

<blockquote>
<p>Lets pretend we have other functions and create more tasks&hellip;</p>
</blockquote>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">task2</span> <span class="o">=</span> <span class="nx">lab</span><span class="p">.</span><span class="nx">newTask</span><span class="p">(</span><span class="s2">"cpTask"</span><span class="p">,</span><span class="nx">setup2</span><span class="p">,</span><span class="nx">verifier2</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">task3</span> <span class="o">=</span> <span class="nx">lab</span><span class="p">.</span><span class="nx">newTask</span><span class="p">(</span><span class="s2">"mvTask"</span><span class="p">,</span><span class="nx">setup3</span><span class="p">,</span><span class="nx">verifier3</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">task4</span> <span class="o">=</span> <span class="nx">lab</span><span class="p">.</span><span class="nx">newTask</span><span class="p">(</span><span class="s2">"rmTask"</span><span class="p">,</span><span class="nx">setup4</span><span class="p">,</span><span class="nx">verifier4</span><span class="p">);</span>

</code></pre>

<blockquote>
<p>Now lets chain our tasks in the tasks() method&hellip;</p>
</blockquote>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">tasks</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">mylab</span><span class="p">.</span><span class="nx">init</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">nextTask</span><span class="p">(</span><span class="nx">task1</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">nextTask</span><span class="p">(</span><span class="nx">task2</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">nextTask</span><span class="p">(</span><span class="nx">task3</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">nextTask</span><span class="p">(</span><span class="nx">task4</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p>Tasks are chained using the nextTask method, in a function named tasks. Task chains should start with a lab.init() call.</p>

<h3 id="export">Export</h3>
<pre class="highlight javascript"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">myLab</span><span class="p">;</span>
</code></pre>

<p>At the end of the lab file, You must export the lab object you created and modified, exporting it in the standard npm way with the <code>module.exports</code> command.</p>

<h2 id="manipulating-the-vm">Manipulating the VM</h2>

<p>In order to setup, and control the VM, TuxLab provides access to the <code class="prettyprint">env</code> object, which allows you to control the VM, and even create other VMs:</p>

<blockquote>
<p>All API calls are easily chainable</p>
</blockquote>
<pre class="highlight javascript"><code>
<span class="nx">env</span><span class="p">.</span><span class="nx">init</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"echo hello world"</span><span class="p">));</span>

</code></pre>

<p>The Environment API consists of functions that allow users to create, modify and run commands on docker containers, reliant on the docker remote API. All functions are promise.js based and can be chained very easily with <code>.then</code> commands.</p>
<pre class="highlight javascript"><code>
<span class="nx">env</span><span class="p">.</span><span class="nx">init</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"echo hello world"</span><span class="p">),</span>
  <span class="cm">/*failure case*/</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="cm">/*general failure case*/</span><span class="p">);</span>
</code></pre>

<p>Similarly, errors can be thrown and caught either at individual steps or after full execution -or both-, using the promise.js standard of either providing a failure case in the <code>Promise.then</code> case, or using a <code>.catch</code> statement</p>

<h3 id="env-init">Env.init()</h3>

<p>Initializes the environment for a unique student, creating a lab Virtual Machine for each student and allowing them to connect to it remotely, via their own terminal or our browser interface</p>

<h3 id="env-start">Env.start()</h3>

<p>Is a placeholder for chaining.</p>

<h3 id="env-shell">Env.shell()</h3>
<pre class="highlight javascript"><code><span class="nx">env</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"echo hello world"</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">sOut</span><span class="p">,</span> <span class="nx">sErr</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sOut</span><span class="p">,</span><span class="nx">sErr</span><span class="p">);});</span>

</code></pre>

<blockquote>
<p>Don&rsquo;t forget, you can just clone git repositories.</p>
</blockquote>
<pre class="highlight javascript"><code><span class="nx">env</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"cd /"</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"git clone https://github.com/learnlinux/tuxlab-app"</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">shell</span><span class="p">(</span><span class="s2">"labVm"</span><span class="p">,</span><span class="s2">"./deploy.sh"</span><span class="p">));</span>
</code></pre>

<p>Env.shell allows running classic shell commands in any Virtual Machine created using the Env API. The call Env.shell(vmName, command) results in a promise, resolved with standard out, standard error or rejects with null and an error.
Every command in the student environment, aside from creating, updating, removing or networking virtual machines are meant to be implemented through env.shell().
<aside class = "success">Remember, you can always clone your files from github and run them</aside></p>

<p>Keep in mind that env.shell can easily be used to clone a git repository of your choice and run any executable you would like to put there since env.shell is capable of running any unix command. Including git clone and many others!</p>

<h3 id="env-createvm">Env.createVm()</h3>
<pre class="highlight javascript"><code><span class="nx">env</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">createVm</span><span class="p">({</span><span class="na">createOptions</span><span class="p">:</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="s2">"Jonathan"</span><span class="p">}});</span>
</code></pre>

<p>Env.createVm creates a virtual machine in addition to the labVm. Although not necessary for many labs, creating multiple virtual machines may allow the creation of more versatile labs. Using Env.network -to be implemented in beta- you can network together any number of Virtual Machines in whatever way you wish to create many different labs such as SSH-connection, server-hacking &hellip;</p>

<h3 id="env-updatevm">Env.updateVm()</h3>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">attachStdErr</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">name</span><span class="p">:</span> <span class="s2">"Jeff"</span><span class="p">,</span>
  <span class="na">CMD</span><span class="p">:</span> <span class="p">[</span><span class="s2">"/bin/sh"</span><span class="p">]</span>
<span class="p">}</span>

<span class="nx">env</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
 <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">updateVm</span><span class="p">(</span><span class="s2">"vm1"</span><span class="p">,</span><span class="nx">opts</span><span class="p">));</span>
</code></pre>

<p>Env.update vm, updates a virtual machine with the given options. Although it can work with the labVm and all other Vms, we highly suggest not using it to update labVm as this may affectthe student connection</p>

<aside class = "warning">Using updateVm on the labVm may result in unexpected behavior!</aside>

<h3 id="env-removevm">Env.removeVm()</h3>
<pre class="highlight javascript"><code><span class="nx">env</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">env</span><span class="p">.</span><span class="nx">removeVm</span><span class="p">(</span><span class="s2">"Jeff"</span><span class="p">));</span>
</code></pre>

<p>Removes any virtual machine except the labVm. It is suggested that you use the removeVm call to remove virtual machines after they&rsquo;ll no longer be used to save resources. All virtual machines are terminated after a pre-determined countdown or when the student completes the lab.</p>

<h2 id="accessing-student-data">Accessing Student Data</h2>

<p>Inside of the functions described in the LabFile, you are given access to a Student object, which allows you to save data to the Users&rsquo; account, provide the user feedback, and save grades for the user.</p>

<h3 id="student-feedback">Student.feedback()</h3>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">md</span> <span class="o">=</span> <span class="err">`</span>
  <span class="err">#</span> <span class="nx">This</span> <span class="nx">is</span> <span class="nx">an</span> <span class="nx">example</span> <span class="nx">feedback</span> <span class="nx">MD</span>
  <span class="err">##</span> <span class="nx">It</span> <span class="nx">works</span> <span class="k">in</span> <span class="nx">full</span> <span class="nx">markdown</span>
  <span class="nx">You</span> <span class="nx">can</span> <span class="k">do</span> <span class="nx">most</span> <span class="nx">things</span> <span class="kd">with</span> <span class="nx">it</span>
  <span class="err">`</span><span class="p">;</span>

<span class="nx">student</span><span class="p">.</span><span class="nx">feedback</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">md</span><span class="p">);</span>
</code></pre>

<p>Shows the feedback markdown provided to the student below the original task markdown once the verifier function runs. It is recommended that this is only called in the verifier function.</p>

<h3 id="student-setgrade">Student.setGrade()</h3>
<pre class="highlight javascript"><code><span class="nx">student</span><span class="p">.</span><span class="nx">setGrade</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</code></pre>

<p>Sets the grade of the student for a specific task to the given tuple. Takes two parameters, taskNo, gradeTuple. Grade is set to tuple[0] out of tuple[1]</p>

<h3 id="student-incrementgrade">Student.incrementGrade()</h3>
<pre class="highlight javascript"><code><span class="nx">student</span><span class="p">.</span><span class="nx">incrementGrade</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</code></pre>

<p>increments the grade of the student for a specific task by the given number of points</p>

<h3 id="student-gettaskdata">Student.getTaskData()</h3>
<pre class="highlight javascript"><code><span class="nx">env</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">student</span><span class="p">.</span><span class="nx">getTaskData</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)});</span>
</code></pre>

<p>Like env functions, student.getTaskData can only be called as part of a chain starting with an env.init() or env.start() call. It is a promise based function that returns a promise that either resolves with the data or rejects. For non-corrupt databases, rejecting should not be an issue. The call takes as a parameter the index -from 1- for which the data is asked.</p>

<h3 id="student-settaskdata">Student.setTaskData()</h3>
<pre class="highlight javascript"><code><span class="nx">student</span><span class="p">.</span><span class="nx">setTaskData</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
</code></pre>

<p>asynchronously sets the task data to the data provided. The first argument provided in the call is the task number -starting from 1- for the task to modify.</p>

<h3 id="student-getlabdata">Student.getLabData()</h3>
<pre class="highlight javascript"><code><span class="nx">env</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">student</span><span class="p">.</span><span class="nx">getLabData</span><span class="p">())</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">});</span>
</code></pre>

<p>Like env functions, student.getLabData can only be called as part of a chain starting with an env.init() or env.start() call. It is a promise based function that returns a promise which either resolves with the lab data or rejects. For non-corrupt databases, rejecting should not be an issue.</p>

<h3 id="student-setlabdata">Student.setLabData()</h3>
<pre class="highlight javascript"><code><span class="nx">student</span><span class="p">.</span><span class="nx">setLabData</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</code></pre>

<p>Asynchronously sets the lab data to the data provided.</p>

          <h1 id="troubleshooting">Troubleshooting</h1>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
